import"https://cdn.jsdelivr.net/npm/core-js-bundle@3.45/minified.js";import"https://cdn.jsdelivr.net/npm/regenerator-runtime/runtime.min.js";import{isDesktop,touch,showMenu,setupLangNavEvents,initNavToggle,initAnimationObserver,scrollToTop,initSpotlightCursor,spotlight,fetchGalleryData,translationSetup,menuBtn}from"./utils.js";let jsModuleObserver,lastCardObserver,langData;function initCardModuleObserver(){jsModuleObserver=new IntersectionObserver(async e=>{for(var a of e){var t=a.target;if(a.isIntersecting&&t.dataset.module&&"true"!==t.dataset.loader)try{var r=(await import(`./gallery/${t.dataset.module}.js`))["init"+capitalize(t.dataset.module)];"function"==typeof r&&(r(t),t.dataset.loaded="true",jsModuleObserver.unobserve(t))}catch(e){console.error(`Module failed to load: ${t.dataset.module}:`,e)}}},{threshold:.3})}function observeGalleryCards(a){document.querySelectorAll(".gallery__card:not(.observed)").forEach(e=>{touch&&e.dataset.animated&&a.observe(e),e.dataset.module&&jsModuleObserver.observe(e),e.classList.add("observed")})}document.addEventListener("DOMContentLoaded",async()=>{langData=await translationSetup(),initNavToggle(isDesktop,langData);initAnimationObserver();initCardModuleObserver(),setupLoaderObserver(),touch?spotlight.style.display="none":initSpotlightCursor(),observeGalleryCards()}),window.addEventListener("resize",()=>{showMenu(isDesktop),setupLangNavEvents()}),window.onscroll=function(){scrollToTop()};let gallery=document.getElementById("css-challenge-gallery"),loader=document.getElementById("loader"),dataCache=null,lastCardIndex=0,cardsPerLoad=6,hasMore=!0;function setupLoaderObserver(){(lastCardObserver=new IntersectionObserver(e=>{e=e[0];e.isIntersecting&&(e.target.classList.toggle("show"),setTimeout(loadCards,800))},{threshold:1})).observe(loader)}async function loadCards(){var e;hasMore&&((e=await fetchGalleryData()).slice(lastCardIndex,lastCardIndex+cardsPerLoad).forEach(createCard),observeGalleryCards(initAnimationObserver()),lastCardIndex+=cardsPerLoad,hasMore=lastCardIndex<e.length,window.scrollBy(0,-250),hasMore||(loader.style.display="none"),loader.classList.toggle("show"))}function createCard(e){var a=document.createElement("article"),t=String(e.day).padStart(2,"0");a.className="card show gallery__card card-"+t,a.tabIndex=0,e.isAnimated&&(a.dataset.animated=!0),e.isInteractive&&a.classList.add("interact"),e.JSModule&&(a.dataset.module="card"+t),"en"!==langData.html_lang.lang&&(e.title=langData.gallery_card_title[t-1]),a.innerHTML=`<div class="card__top">${e.content}</div>
        <div class="card__bar">
        <h2 class="card__bar__header">Day <span>#</span>${e.day}</h2>
        <p class="card__bar__title">${e.title}</p>
        </div>`,gallery.appendChild(a)}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}